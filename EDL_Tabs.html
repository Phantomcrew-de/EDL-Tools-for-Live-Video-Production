<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>EDL-Tools Roundtrip Suite</title>
  <style>
    body { background: #181818; color: #eee; margin: 0; font-family: sans-serif; }
    .tab-container { display: flex; background: #222; }
    .tab {
      cursor: pointer;
      padding: 12px 22px;
      color: #aaa;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 17px;
      position: relative;
      transition: background 0.3s;
      border-bottom: 2.5px solid transparent;
    }
    .tab.active {
      background: #444;
      color: #fff;
      border-bottom: 2.5px solid #30c7ff;
    }
    .tab-content {
      display: none;
      height: calc(100vh - 48px);
      position: absolute;
      top: 48px;
      left: 0;
      width: 100vw;
      background: #222;
      z-index: 0;
      overflow: hidden;
    }
    .tab-content .swipe-inner {
      width: 100%;
      height: 100%;
      transition: transform 0.4s cubic-bezier(0.77,0,0.18,1);
      will-change: transform;
      background: #222;
    }
    .tab-content.active {
      display: block;
      z-index: 1;
    }
    .github-link {
      margin-left: auto;
      display: flex;
      align-items: center;
      padding: 0 16px;
      text-decoration: none;
      background: none;
      border: none;
      cursor: pointer;
      height: 48px;
    }
    .github-link svg {
      width: 26px;
      height: 26px;
      fill: #aaa;
      transition: fill 0.2s;
    }
    .github-link:hover svg {
      fill: #30c7ff;
    }
    /* Keyframes f√ºr swipe */
    @keyframes swipe-in-left { from { transform: translateX(-100vw); } to { transform: translateX(0); } }
    @keyframes swipe-out-left { from { transform: translateX(0); } to { transform: translateX(-100vw); } }
    @keyframes swipe-in-right { from { transform: translateX(100vw); } to { transform: translateX(0); } }
    @keyframes swipe-out-right { from { transform: translateX(0); } to { transform: translateX(100vw); } }
  </style>
</head>
<body>
  <div class="tab-container">
    <div class="tab active" data-target="offset" data-hash="#offset">üßÆ Offset-Editor</div>
    <div class="tab" data-target="atem" data-hash="#atem">üéõÔ∏è ATEM Tool</div>
    <div class="tab" data-target="resolve" data-hash="#resolve">üé¨ Resolve Player</div>
    <div class="tab" data-target="help" data-hash="#help">üìö Read Me</div>
    <a
      class="github-link"
      href="https://github.com/phantomcrew-de/EDL-Tools-for-Live-Video-Production"
      target="_blank"
      title="GitHub Repository"
      rel="noopener"
      id="github-link"
    >
      <svg viewBox="0 0 16 16">
        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38
        0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52
        0-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95
        0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2
        .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15
        0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013
        8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
      </svg>
    </a>
  </div>
  <div class="tab-content active" id="tab-offset" style="position: absolute;">
    <div class="swipe-inner">
      <iframe id="iframe-offset" src="EDL_Offset_Editor_1_1_EN.html"></iframe>
    </div>
  </div>
  <div class="tab-content" id="tab-atem" style="position: absolute;">
    <div class="swipe-inner">
      <iframe id="iframe-atem" src="EDL_for_ATEM_live_production_1_1_DE.html"></iframe>
    </div>
  </div>
  <div class="tab-content" id="tab-resolve" style="position: absolute;">
    <div class="swipe-inner">
      <iframe id="iframe-resolve" src="EDL_video_player_for_resolve_1_1_DE.html"></iframe>
    </div>
  </div>
  <div class="tab-content" id="tab-help" style="position: absolute;">
    <div class="swipe-inner">
      <iframe id="iframe-help" src="https://phantomcrew-de.github.io/EDL-Tools-for-Live-Video-Production/"></iframe>
    </div>
  </div>
  <script>
    window.globalEDLText = "";
    let tabOrder = ["offset","atem","resolve","help"];
    let currentTab = "offset";

    function doSwipe(outTab, inTab, dir) {
      if (!outTab || !inTab) return;
      const outContent = outTab.querySelector('.swipe-inner');
      const inContent = inTab.querySelector('.swipe-inner');
      if (!outContent || !inContent) return;

      // Reset all
      outContent.style.animation = '';
      inContent.style.animation = '';
      inContent.style.transform = '';
      outContent.style.transform = '';

      // Prepare
      inTab.classList.add('active');
      inContent.style.animation = `swipe-in-${dir} 0.42s cubic-bezier(0.77,0,0.18,1)`;
      inTab.style.zIndex = 2;
      outTab.style.zIndex = 1;

      // Starte out animation
      outContent.style.animation = `swipe-out-${dir} 0.42s cubic-bezier(0.77,0,0.18,1)`;

      setTimeout(() => {
        outTab.classList.remove('active');
        inTab.classList.add('active');
        outTab.style.zIndex = 0;
        inTab.style.zIndex = 1;
        inContent.style.animation = '';
        outContent.style.animation = '';
      }, 420);
    }

    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        const nextTab = tab.dataset.target;
        if (nextTab === currentTab) return;
        // Hash
        window.location.hash = tab.dataset.hash;
        exportEDLFromTab(currentTab);

        // Tabs
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');

        // Animation Richtung
        const fromIdx = tabOrder.indexOf(currentTab);
        const toIdx = tabOrder.indexOf(nextTab);
        let dir = (toIdx > fromIdx) ? 'right' : 'left';

        const currentContent = document.getElementById('tab-' + currentTab);
        const nextContent = document.getElementById('tab-' + nextTab);

        doSwipe(currentContent, nextContent, dir);

        setTimeout(() => importEDLToTab(nextTab), 200);
        currentTab = nextTab;
      });
    });

    // On load, korrekter Tab
    window.addEventListener('DOMContentLoaded', () => {
      const hash = window.location.hash || '#offset';
      const targetTab = Array.from(document.querySelectorAll('.tab')).find(tab => tab.dataset.hash === hash);
      if (targetTab) targetTab.click();
      // Fix: Zeige nur den aktuellen Content
      document.querySelectorAll('.tab-content').forEach((div, idx) => {
        if (!div.classList.contains('active')) div.style.zIndex = 0;
        else div.style.zIndex = 1;
      });
    });
    // Hash-√Ñnderung (z.B. per Browsernavigation) setzt Tab
    window.addEventListener('hashchange', () => {
      const hash = window.location.hash;
      const targetTab = Array.from(document.querySelectorAll('.tab')).find(tab => tab.dataset.hash === hash);
      if (targetTab) targetTab.click();
    });

    function exportEDLFromTab(tabId) {
      document.getElementById('iframe-' + tabId).contentWindow.postMessage({type: 'EXPORT_EDL'}, '*');
    }
    function importEDLToTab(tabId) {
      if (window.globalEDLText && window.globalEDLText.length > 0)
        document.getElementById('iframe-' + tabId).contentWindow.postMessage({type: 'IMPORT_EDL', edl: window.globalEDLText}, '*');
    }
    window.addEventListener('message', (event) => {
      if (event.data.type === 'EXPORT_RESULT' && typeof event.data.edl === 'string') {
        window.globalEDLText = event.data.edl;
      }
    });
  </script>
</body>
</html>
